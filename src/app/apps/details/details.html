<sub-navbar items="adc.navItems">
  <span class="md-body-2">Scenarios:</span>
  <md-button class="md-fab md-primary md-hue-1 md-mini" aria-label="Scenario 1"
             ng-click="adc.openScenarioDialog($event, 1)">
    <span class="md-body-2">1</span>
  </md-button>
  <md-button class="md-fab md-primary md-hue-1 md-mini" aria-label="Scenario 2"
             ng-click="adc.openScenarioDialog($event, 2)">
    <span class="md-body-2">2</span>
  </md-button>
  <md-button class="md-fab md-primary md-hue-1 md-mini" aria-label="Scenario 3"
             ng-click="adc.openScenarioDialog($event, 3)">
    <span class="md-body-2">3</span>
  </md-button>
</sub-navbar>

<div layout="column" layout-gt-md="row" layout-fill>
  <div flex="70" class="md-whiteframe-1dp" layout="column" layout-fill>

    <div layout="start center">
      <span class="md-title md-padding">Details of {{adc.app.name}}</span>
      <span flex></span>
      <md-button class="md-raised" ng-click="adc.deploy()" ng-show="adc.app.status=='ready'"
                 ng-disabled="adc.app.status=='deployed' || adc.app.deploying">
        <span ng-hide="adc.app.deploying">Deploy</span>
        <span ng-show="adc.app.deploying">Deploying...</span>
      </md-button>
    </div>

    <md-tabs layout-fill class="md-accent md-hue-1 tabs-section">
      <md-tab label="General">
        <md-content layout="column" class="md-body-1 md-padding">
          <md-list>
            <md-list-item class="md-2-line">
              <div class="md-list-item-text" layout="column">
                <h4>Status</h4>
                <p>{{adc.app.status}}</p>
                <p ng-hide="!adc.getStatusMessage(adc.app.status)">{{adc.getStatusMessage(adc.app.status)}}</p>
                <br><!-- TODO: remove this layout-hack -->
              </div>
            </md-list-item>
            <md-list-item class="md-2-line">
              <div class="md-list-item-text" layout="column">
                <h4>Logs</h4>
                <p ng-repeat="log in adc.app.log">
                  <span>{{log.createdAt | amDateFormat:'DD.MM.YYYY HH:mm:ss'}}</span><span>{{': ' + log.content}}</span>
                </p>
              </div>
            </md-list-item>
          </md-list>
        </md-content>
      </md-tab>
      <md-tab ng-repeat="organ in adc.app.organs" label="{{organ.originalName}}">
        <md-content layout="row" class="md-body-1 md-padding">
          <div flex layout="column">
            <md-button ng-show="adc.app.status=='deployed'" class="md-raised" aria-label="Scale Up"
                       ng-click="adc.scaleUp(organ)">
              <span>Scale Up</span>
            </md-button>
            <md-list>
              <md-list-item class="md-2-line md-padding" ng-show="organ.cells && organ.cells.length > 0">
                <div ng-repeat="cell in organ.cells" layout="row" flex>
                  <div class="md-list-item-text" layout="column">
                    <h4>Cell {{$index + 1}}</h4>
                    <p>Provider: {{adc.selections.provider[cell.host.labels.provider] || 'undefined'}}</p>
                    <p>Region: {{adc.selections.region[cell.host.labels.region] || 'undefined'}}</p>
                    <p>Tier: {{adc.selections.tier[cell.host.labels.tier] || 'undefined'}}</p>
                    <p ng-hide="cell.published_port">IP: {{cell.host.ip}}</p>
                    <p ng-show="cell.published_port">IP:
                      <a target="_blank"
                         href="{{'http://' + cell.host.ip + ':' + cell.published_port}}">{{cell.host.ip +
                        ':'
                        + cell.published_port}}</a>
                    </p>
                    <md-button class="md-raised" aria-label="Kill" ng-click="adc.scaleDown(organ, cell)"
                               ng-show="adc.app.status=='deployed' && !cell.isProxy">
                      <span>Kill</span>
                    </md-button>
                    <md-menu md-position-mode="target target" ng-show="adc.app.status=='deployed' && !cell.isProxy">
                      <md-button class="md-raised" aria-label="Move" ng-disabled="cell.moving"
                                 ng-click="$mdOpenMenu($event)">
                        <span ng-hide="cell.moving">Move</span>
                        <span ng-show="cell.moving">Moving...</span>
                      </md-button>
                      <md-menu-content class="md-body-1" width="4">
                        <section>
                          <form ng-init="data={}">
                            <div ng-repeat="option in adc.getKeys(adc.selections)">
                              <span layout-padding class="md-body-1">{{option.substring(0,1).toUpperCase() + option.substring(1) + ':'}}</span>
                              <md-radio-group ng-model="data[option]" ng-init="data[option] = ''">
                                <md-radio-button value="" class="md-primary">(No preference)</md-radio-button>
                                <md-radio-button ng-repeat="short in adc.getKeys(adc.selections[option])"
                                                 ng-class="{'md-primary': short==cell.host.labels[option]}"
                                                 value="{{short}}">
                                  {{adc.selections[option][short]}}
                                </md-radio-button>
                              </md-radio-group>
                              <hr/>
                            </div>
                            <md-button ng-disabled="adc.disableButton(data, cell.host.labels)" class="md-raised"
                                       ng-click="adc.move(cell, data)">
                              Apply
                            </md-button>
                          </form>
                        </section>
                      </md-menu-content>
                    </md-menu>
                  </div>
                </div>
              </md-list-item>
              <md-list-item class="md-2-line">
                <div class="md-list-item-text" layout="column">
                  <h4>Image</h4>
                  <p>{{organ.image}}</p>
                </div>
              </md-list-item>
              <md-list-item class="md-2-line">
                <div class="md-list-item-text" layout="column">
                  <h4>Environment</h4>
                  <p ng-repeat="item in organ.environment">{{item}}</p>
                </div>
              </md-list-item>
              <md-list-item class="md-2-line" ng-hide="!organ.expose || organ.expose.length == 0">
                <div class="md-list-item-text" layout="column">
                  <h4>Exposed ports</h4>
                  <p ng-repeat="item in organ.expose">{{item}}</p>
                </div>
              </md-list-item>
            </md-list>
          </div>
        </md-content>
      </md-tab>
    </md-tabs>
  </div>
<!--  <div flex="30" ng-show="adc.app.status == 'deployed'" class="md-whiteframe-0dp" layout="column" layout-fill
       layout-align="start center">
    <chart></chart>
  </div>-->
</div>
